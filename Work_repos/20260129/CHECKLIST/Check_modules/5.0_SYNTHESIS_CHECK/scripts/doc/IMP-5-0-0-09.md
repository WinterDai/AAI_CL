# IMP-5-0-0-09: Confirm Latches Inferred documented?

## Overview

**Checker ID**: IMP-5-0-0-09  
**Module**: 5.0_SYNTHESIS_CHECK  
**Description**: Validates that all latches inferred during synthesis are properly documented in the design configuration.

**Purpose**:
- Detect latches inferred by the synthesis tool from latch.rpt
- Verify that all inferred latches are documented in requirements.pattern_items
- Prevent undocumented latches from entering the design
- Support waiver mechanisms for intentional latches

**Architecture**: Inherits from `BaseChecker` with support for all 4 checking types (Type 1/2/3/4)

---

## Check Logic

### Input Files
The checker processes latch reports specified in `DATA_INTERFACE.yaml`:

```yaml
IMP-5-0-0-09:
  requirements:
    value: 0  # or N/A
    pattern_items:  # List of documented latch cell names
      - CKLNQD1BWP143M286H3P48CPDLVT
      - LATCH_CELL_NAME_2
  waivers:
    value: 0  # or N/A, or >0 for Type 3/4
    pattern_items:  # Waiver patterns (Type 3/4 only)
      - WAIVED_LATCH_*
  input_files:
    - latch.rpt
```

### Parsing Logic

The checker extracts latch cell names from `latch.rpt` using pattern matching:

**Report Format**:
```
inst:<instance_path> <libset>/<library>/<LATCH_CELL_NAME>
```

**Example**:
```
inst:path/to/instance libset_ssgnp/tcbn03e_base_lvt/CKLNQD1BWP143M286H3P48CPDLVT
inst:another/path libset_ssgnp/tcbn03e_base_lvt/CKLNQD1BWP143M286H3P48CPDLVT
```

**Extraction Pattern**:
```python
pattern = re.compile(r'^inst:(\S+)\s+(.+)/([A-Z0-9_]+)\s*$', re.IGNORECASE)
# Captures: (instance_path, library_path, LATCH_CELL_NAME)
```

**Metadata Tracking**:
For each unique latch cell name, the checker tracks:
- First occurrence line number
- File path (latch.rpt)
- Total occurrence count (how many instances use this latch)

### Type Detection

The checker automatically detects its type based on configuration:

| requirements.value | waivers.value | Detected Type | Behavior |
|-------------------|---------------|---------------|----------|
| N/A | N/A or 0 | **Type 1** | Informational only, always PASS |
| > 0 | N/A or 0 | **Type 2** | FAIL if undocumented latches exist |
| > 0 | > 0 | **Type 3** | FAIL if unwaived undocumented latches exist |
| N/A | > 0 | **Type 4** | FAIL if unwaived latches exist |

---

## Type 1: Informational Check

### Configuration
```yaml
IMP-5-0-0-09:
  requirements:
    value: N/A
    pattern_items: []
  waivers:
    value: N/A
    pattern_items: []
  input_files:
    - latch.rpt
```

### Behavior
- **Always PASS** regardless of latches found
- Reports all latches as informational items
- No validation against documented list
- Useful for design exploration or early stages

### Example Output

**Scenario**: 2 latch cells found in latch.rpt

**latch.rpt**:
```
inst:cpu/ctrl/latch_1 libset_ssgnp/tcbn03e_base_lvt/CKLNQD1BWP143M286H3P48CPDLVT
inst:cpu/ctrl/latch_2 libset_ssgnp/tcbn03e_base_lvt/CKLNQD1BWP143M286H3P48CPDLVT
inst:cpu/mem/latch_3 libset_ssgnp/tcbn03e_base_lvt/CKLNQD1BWP143M286H3P48CPDLVT
inst:cpu/mem/latch_4 libset_ssgnp/tcbn03e_base_lvt/CKLNQD1BWP143M286H3P48CPDLVT
```

**Report Output**:
```
PASS:IMP-5-0-0-09:Confirm Latches Inferred documented?
IMP-5-0-0-09-INFO01: Check result:

Info Occurrence: 1
1: Info: CKLNQD1BWP143M286H3P48CPDLVT. In line 1, C:\...\latch.rpt: Latch cell inferred (count: 4, informational only)
```

**Explanation**:
- Status: **PASS** (Type 1 always passes)
- Found 1 unique latch cell: `CKLNQD1BWP143M286H3P48CPDLVT`
- Total 4 instances using this latch cell
- All reported as INFO with "(informational only)" tag

---

## Type 2: Value Check (Documentation Validation)

### Configuration
```yaml
IMP-5-0-0-09:
  requirements:
    value: 0  # Expect 0 undocumented latches
    pattern_items:  # List of documented latch cells
      - CKLNQD1BWP143M286H3P48CPDLVT
      - LATCH_CELL_APPROVED
  waivers:
    value: N/A
    pattern_items: []
  input_files:
    - latch.rpt
```

### Behavior
- **PASS** if all found latches are in pattern_items
- **FAIL** if any undocumented latches exist
- **WARN** if latches found but pattern_items is empty (configuration issue)

### Example 1: All Latches Documented (PASS)

**latch.rpt**:
```
inst:cpu/ctrl/latch_1 libset_ssgnp/tcbn03e_base_lvt/CKLNQD1BWP143M286H3P48CPDLVT
inst:cpu/ctrl/latch_2 libset_ssgnp/tcbn03e_base_lvt/CKLNQD1BWP143M286H3P48CPDLVT
```

**Configuration**:
```yaml
requirements:
  value: 0
  pattern_items:
    - CKLNQD1BWP143M286H3P48CPDLVT
```

**Report Output**:
```
PASS:IMP-5-0-0-09:Confirm Latches Inferred documented?
IMP-5-0-0-09-INFO01: Latches Inferred:
  - CKLNQD1BWP143M286H3P48CPDLVT

Info Occurrence: 1
1: Info: CKLNQD1BWP143M286H3P48CPDLVT. In line 1, C:\...\latch.rpt: Latch cell documented (count: 2)
```

**Explanation**:
- Status: **PASS**
- All found latches are in the documented list
- INFO01 shows documented latches
- Detail shows occurrence count

### Example 2: Undocumented Latches Found (FAIL)

**latch.rpt**:
```
inst:cpu/ctrl/latch_1 libset_ssgnp/tcbn03e_base_lvt/CKLNQD1BWP143M286H3P48CPDLVT
inst:cpu/mem/latch_2 libset_ssgnp/tcbn03e_base_lvt/UNDOCUMENTED_LATCH_XYZ
inst:cpu/mem/latch_3 libset_ssgnp/tcbn03e_base_lvt/UNDOCUMENTED_LATCH_XYZ
```

**Configuration**:
```yaml
requirements:
  value: 0
  pattern_items:
    - CKLNQD1BWP143M286H3P48CPDLVT
```

**Report Output**:
```
FAIL:IMP-5-0-0-09:Confirm Latches Inferred documented?
IMP-5-0-0-09-ERROR01: Undocumented latch cells:
  - UNDOCUMENTED_LATCH_XYZ

Fail Occurrence: 1
1: Fail: UNDOCUMENTED_LATCH_XYZ. In line 2, C:\...\latch.rpt: Latch cell used in design but not documented

Info Occurrence: 1
1: Info: CKLNQD1BWP143M286H3P48CPDLVT. In line 1, C:\...\latch.rpt: Latch cell documented (count: 1)
```

**Explanation**:
- Status: **FAIL**
- ERROR01 lists undocumented latches
- `UNDOCUMENTED_LATCH_XYZ` not in pattern_items → FAIL
- `CKLNQD1BWP143M286H3P48CPDLVT` documented → INFO

### Example 3: No Documentation Provided (WARN + PASS)

**latch.rpt**:
```
inst:cpu/ctrl/latch_1 libset_ssgnp/tcbn03e_base_lvt/SOME_LATCH_CELL
```

**Configuration**:
```yaml
requirements:
  value: 0
  pattern_items: []  # Empty - no documentation
```

**Report Output**:
```
PASS:IMP-5-0-0-09:Confirm Latches Inferred documented?
IMP-5-0-0-09-WARN01: Configuration Warning:

IMP-5-0-0-09-INFO01: Latches Inferred:
  - SOME_LATCH_CELL

Warn Occurrence: 1
1: Warn: . In line 0, : Golden value expected but not provided

Info Occurrence: 1
1: Info: SOME_LATCH_CELL. In line 1, C:\...\latch.rpt: Latch cell used and golden value expected but not provided and total count is 1
```

**Explanation**:
- Status: **PASS** (lenient for configuration issues)
- WARN01 alerts: documentation expected but missing
- INFO01 lists found latches
- User should add latches to pattern_items

---

## Type 3: Value Check with Waivers

### Configuration
```yaml
IMP-5-0-0-09:
  requirements:
    value: 0
    pattern_items:
      - DOCUMENTED_LATCH_A
  waivers:
    value: 1  # Allow 1 waived undocumented latch
    pattern_items:
      - WAIVED_LATCH_*
      - TEMP_LATCH_XYZ
    reasons:
      - "WAIVED_LATCH_*: Temporary workaround for clock gating"
      - "TEMP_LATCH_XYZ: To be removed in next revision"
  input_files:
    - latch.rpt
```

### Behavior
- **PASS** if all undocumented latches are waived
- **FAIL** if any unwaived undocumented latches exist
- **WARN** for unused waiver patterns
- Supports wildcard matching (`*`, `?`)

### Example 1: All Undocumented Latches Waived (PASS)

**latch.rpt**:
```
inst:cpu/ctrl/latch_1 libset_ssgnp/tcbn03e_base_lvt/DOCUMENTED_LATCH_A
inst:cpu/mem/latch_2 libset_ssgnp/tcbn03e_base_lvt/WAIVED_LATCH_001
inst:cpu/mem/latch_3 libset_ssgnp/tcbn03e_base_lvt/TEMP_LATCH_XYZ
```

**Report Output**:
```
PASS:IMP-5-0-0-09:Confirm Latches Inferred documented?
IMP-5-0-0-09-INFO01: Undocumented latches waived:
  - [WAIVER] WAIVED_LATCH_001
  - [WAIVER] TEMP_LATCH_XYZ

IMP-5-0-0-09-INFO02: Documented latches:
  - DOCUMENTED_LATCH_A

Info Occurrence: 3
1: Info: [WAIVER] WAIVED_LATCH_001. In line 2, C:\...\latch.rpt: Latch cell undocumented: Temporary workaround for clock gating
2: Info: [WAIVER] TEMP_LATCH_XYZ. In line 3, C:\...\latch.rpt: Latch cell undocumented: To be removed in next revision
3: Info: DOCUMENTED_LATCH_A. In line 1, C:\...\latch.rpt: Latch cell documented (count: 1)
```

**Explanation**:
- Status: **PASS**
- `WAIVED_LATCH_001` matches pattern `WAIVED_LATCH_*` → waived
- `TEMP_LATCH_XYZ` matches exact waiver → waived
- `DOCUMENTED_LATCH_A` is documented → INFO
- All undocumented latches are covered by waivers

### Example 2: Unwaived Undocumented Latches (FAIL)

**latch.rpt**:
```
inst:cpu/ctrl/latch_1 libset_ssgnp/tcbn03e_base_lvt/DOCUMENTED_LATCH_A
inst:cpu/mem/latch_2 libset_ssgnp/tcbn03e_base_lvt/WAIVED_LATCH_001
inst:cpu/io/latch_3 libset_ssgnp/tcbn03e_base_lvt/ILLEGAL_LATCH_XYZ
```

**Configuration**:
```yaml
requirements:
  pattern_items:
    - DOCUMENTED_LATCH_A
waivers:
  pattern_items:
    - WAIVED_LATCH_*
```

**Report Output**:
```
FAIL:IMP-5-0-0-09:Confirm Latches Inferred documented?
IMP-5-0-0-09-ERROR01: Undocumented latch cells (not waived):
  - ILLEGAL_LATCH_XYZ

IMP-5-0-0-09-INFO01: Undocumented latches waived:
  - [WAIVER] WAIVED_LATCH_001

IMP-5-0-0-09-INFO02: Documented latches:
  - DOCUMENTED_LATCH_A

Fail Occurrence: 1
1: Fail: ILLEGAL_LATCH_XYZ. In line 3, C:\...\latch.rpt: Latch cell used in design but not documented (not waived)

Info Occurrence: 2
1: Info: [WAIVER] WAIVED_LATCH_001. In line 2, C:\...\latch.rpt: Latch cell undocumented: Temporary workaround for clock gating
2: Info: DOCUMENTED_LATCH_A. In line 1, C:\...\latch.rpt: Latch cell documented (count: 1)
```

**Explanation**:
- Status: **FAIL**
- `ILLEGAL_LATCH_XYZ` is neither documented nor waived → ERROR01
- `WAIVED_LATCH_001` matches waiver pattern → INFO with [WAIVER]
- `DOCUMENTED_LATCH_A` is documented → INFO

### Example 3: Unused Waiver Patterns (WARN)

**latch.rpt**:
```
inst:cpu/ctrl/latch_1 libset_ssgnp/tcbn03e_base_lvt/DOCUMENTED_LATCH_A
```

**Configuration**:
```yaml
requirements:
  pattern_items:
    - DOCUMENTED_LATCH_A
waivers:
  pattern_items:
    - WAIVED_LATCH_*  # Not used
    - TEMP_LATCH_XYZ  # Not used
  reasons:
    - "WAIVED_LATCH_*: Unused waiver pattern"
    - "TEMP_LATCH_XYZ: Unused waiver pattern"
```

**Report Output**:
```
PASS:IMP-5-0-0-09:Confirm Latches Inferred documented?
IMP-5-0-0-09-WARN01: Unused waiver patterns:
  - WAIVED_LATCH_*
  - TEMP_LATCH_XYZ

IMP-5-0-0-09-INFO01: Latches Inferred:
  - DOCUMENTED_LATCH_A

Warn Occurrence: 2
1: Warn: WAIVED_LATCH_*. In line 0, : Unused waiver pattern
2: Warn: TEMP_LATCH_XYZ. In line 0, : Unused waiver pattern

Info Occurrence: 1
1: Info: DOCUMENTED_LATCH_A. In line 1, C:\...\latch.rpt: Latch cell documented (count: 1)
```

**Explanation**:
- Status: **PASS**
- All latches are documented, no waivers needed
- WARN01 flags unused waiver patterns
- Consider removing unused waivers from configuration

---

## Type 4: Boolean Check with Waivers

### Configuration
```yaml
IMP-5-0-0-09:
  requirements:
    value: N/A  # No documented list
  waivers:
    value: 1
    pattern_items:
      - ALLOWED_LATCH_*
      - SPECIFIC_LATCH_NAME
    reasons:
      - "ALLOWED_LATCH_*: Approved for clock domain crossing"
      - "SPECIFIC_LATCH_NAME: Design constraint requirement"
  input_files:
    - latch.rpt
```

### Behavior
- **PASS** if all latches are waived OR no latches exist
- **FAIL** if any unwaived latches exist
- No documentation list (pattern_items not used)
- All latches must be explicitly waived

### Example 1: All Latches Waived (PASS)

**latch.rpt**:
```
inst:cpu/cdc/latch_1 libset_ssgnp/tcbn03e_base_lvt/ALLOWED_LATCH_001
inst:cpu/cdc/latch_2 libset_ssgnp/tcbn03e_base_lvt/ALLOWED_LATCH_002
inst:cpu/ctrl/latch_3 libset_ssgnp/tcbn03e_base_lvt/SPECIFIC_LATCH_NAME
```

**Report Output**:
```
PASS:IMP-5-0-0-09:Confirm Latches Inferred documented?
IMP-5-0-0-09-INFO01: Latch cells waived:
  - [WAIVER] ALLOWED_LATCH_001
  - [WAIVER] ALLOWED_LATCH_002
  - [WAIVER] SPECIFIC_LATCH_NAME

Info Occurrence: 3
1: Info: [WAIVER] ALLOWED_LATCH_001. In line 1, C:\...\latch.rpt: Latch cell inferred: Approved for clock domain crossing
2: Info: [WAIVER] ALLOWED_LATCH_002. In line 2, C:\...\latch.rpt: Latch cell inferred: Approved for clock domain crossing
3: Info: [WAIVER] SPECIFIC_LATCH_NAME. In line 3, C:\...\latch.rpt: Latch cell inferred: Design constraint requirement
```

**Explanation**:
- Status: **PASS**
- All 3 latches match waiver patterns
- `ALLOWED_LATCH_001/002` match wildcard `ALLOWED_LATCH_*`
- `SPECIFIC_LATCH_NAME` matches exact waiver

### Example 2: Unwaived Latches Found (FAIL)

**latch.rpt**:
```
inst:cpu/cdc/latch_1 libset_ssgnp/tcbn03e_base_lvt/ALLOWED_LATCH_001
inst:cpu/err/latch_2 libset_ssgnp/tcbn03e_base_lvt/UNEXPECTED_LATCH_XYZ
```

**Configuration**:
```yaml
waivers:
  value: 1
  pattern_items:
    - ALLOWED_LATCH_*
```

**Report Output**:
```
FAIL:IMP-5-0-0-09:Confirm Latches Inferred documented?
IMP-5-0-0-09-ERROR01: Unwaived latch cells:
  - UNEXPECTED_LATCH_XYZ

IMP-5-0-0-09-INFO01: Latch cells waived:
  - [WAIVER] ALLOWED_LATCH_001

Fail Occurrence: 1
1: Fail: UNEXPECTED_LATCH_XYZ. In line 2, C:\...\latch.rpt: Latch cell inferred (count: 1, not waived)

Info Occurrence: 1
1: Info: [WAIVER] ALLOWED_LATCH_001. In line 1, C:\...\latch.rpt: Latch cell inferred: Waived
```

**Explanation**:
- Status: **FAIL**
- `UNEXPECTED_LATCH_XYZ` has no matching waiver → ERROR01
- `ALLOWED_LATCH_001` matches waiver pattern → INFO

### Example 3: No Latches Found (PASS)

**latch.rpt**:
```
(empty or no latch lines)
```

**Report Output**:
```
PASS:IMP-5-0-0-09:Confirm Latches Inferred documented?
IMP-5-0-0-09-INFO01: Check result:

Info Occurrence: 1
1: Info: . In line 0, : No latches inferred in design
```

**Explanation**:
- Status: **PASS**
- No latches found → clean design
- INFO message confirms no latches

---

## Configuration Errors

### ERROR01: Missing Input Files

**Scenario**: latch.rpt not found

**Configuration**:
```yaml
IMP-5-0-0-09:
  input_files:
    - latch.rpt  # File doesn't exist
```

**Report Output**:
```
FAIL:IMP-5-0-0-09:Confirm Latches Inferred documented?
IMP-5-0-0-09-ERROR01: Configuration Error - Missing input files:
  - latch.rpt

Fail Occurrence: 1
1: Fail: latch.rpt. In line 0, : Required input file not found
```

**Solution**:
- Verify file path in DATA_INTERFACE.yaml
- Check that synthesis generated latch.rpt
- Ensure file exists at expected location

---

## FAQ

### Q1: What is a latch and why is it a concern?

**A**: Latches are level-sensitive storage elements (vs. flip-flops which are edge-triggered). In synchronous designs:
- **Unintended latches** often indicate coding errors (incomplete case/if statements)
- **Timing analysis** is more complex for latches
- **DFT** (Design-for-Test) may not support latches well
- **Best practice**: Use flip-flops unless latches are intentionally required

This checker ensures all latches are either:
1. Documented as intentional (Type 2/3)
2. Explicitly waived (Type 3/4)

### Q2: How do I document intentional latches?

**A**: Add latch cell names to `requirements.pattern_items`:

```yaml
IMP-5-0-0-09:
  requirements:
    value: 0
    pattern_items:
      - CKLNQD1BWP143M286H3P48CPDLVT  # Clock gating latch
      - LATCH_CELL_XYZ                # CDC latch
```

Get cell names from the FAIL report or latch.rpt.

### Q3: When should I use waivers vs. documentation?

**Decision Tree**:

```
Is the latch intentional?
├─ Yes → Add to requirements.pattern_items (documented)
└─ No, but temporary/known issue
   ├─ Will be fixed → Add to waivers.pattern_items with reason
   └─ Permanent exception → Consider documenting instead
```

**Type 2** (documentation only):
- Latches are approved design elements
- Permanent, not expected to change

**Type 3/4** (with waivers):
- Temporary workarounds
- Known issues to be fixed
- Third-party IP with latches

### Q4: How are latch cell names extracted?

**A**: From latch.rpt using this pattern:

```
inst:<instance_path> <libset>/<library>/<LATCH_CELL_NAME>
                                          ^^^^^^^^^^^^^^^^
                                          This is extracted
```

**Example**:
```
inst:cpu/ctrl/latch_inst libset_ssgnp/tcbn03e_base_lvt/CKLNQD1BWP143M286H3P48CPDLVT
                                                        ↑
                                      Extracted: CKLNQD1BWP143M286H3P48CPDLVT
```

The checker tracks **unique cell names**, not instance paths.

### Q5: What does "count: 4" mean in the output?

**A**: The number of instances using that latch cell.

**Example**:
```
inst:cpu/ctrl/latch_1 libset/.../LATCH_CELL_A  ← Instance 1
inst:cpu/ctrl/latch_2 libset/.../LATCH_CELL_A  ← Instance 2
inst:cpu/mem/latch_3 libset/.../LATCH_CELL_A   ← Instance 3
inst:cpu/mem/latch_4 libset/.../LATCH_CELL_A   ← Instance 4
```

Output: `LATCH_CELL_A (count: 4)` → 1 unique cell, 4 instances

### Q6: Can I use wildcards in documentation (pattern_items)?

**A**: 
- **Type 2**: Yes, wildcards work in `requirements.pattern_items`
  ```yaml
  pattern_items:
    - LATCH_*  # Matches LATCH_A, LATCH_B, etc.
  ```

- **Type 3/4**: Wildcards work in `waivers.pattern_items`
  ```yaml
  waivers:
    pattern_items:
      - TEMP_LATCH_*
      - CLK_GATE_?_LATCH
  ```

Supported wildcards: `*` (any chars), `?` (single char)

### Q7: What if latch.rpt is empty?

**A**: Empty report = no latches found = **PASS**

```
PASS:IMP-5-0-0-09:Confirm Latches Inferred documented?
Info Occurrence: 1
1: Info: . In line 0, : No latches inferred in design
```

This is the ideal case for most synchronous designs.

### Q8: How do I migrate from Type 2 to Type 3 (add waivers)?

**Steps**:
1. Start with Type 2 configuration (document known latches)
2. Identify temporary/exceptional latches from FAIL report
3. Add waiver configuration:
   ```yaml
   waivers:
     value: 1  # Enable waivers
     pattern_items:
       - TEMP_LATCH_*
     reasons:
       - "TEMP_LATCH_*: Workaround for clock gating, to be fixed in V2"
   ```
4. Checker auto-detects Type 3
5. Review WARN messages for unused waivers

### Q9: Why do I get WARN "Golden value expected but not provided"?

**A**: This occurs in Type 2 when:
- Latches are found in latch.rpt
- `requirements.pattern_items` is empty

**Solution**:
```yaml
# Before (triggers WARN)
requirements:
  value: 0
  pattern_items: []  # Empty

# After (no WARN)
requirements:
  value: 0
  pattern_items:
    - DOCUMENTED_LATCH_NAME  # Add found latches
```

The checker still **PASSES** but warns you to document the latches.

### Q10: How do I override the auto-detected type?

**A**: Pass type as command-line argument:

```bash
# Auto-detect type
python IMP-5-0-0-09.py

# Force Type 1 (informational)
python IMP-5-0-0-09.py 1

# Force Type 4 (boolean with waivers)
python IMP-5-0-0-09.py 4
```

**Use case**: Testing different type behaviors during debugging.

---

## Best Practices

### 1. Start with Type 1 for New Designs

**Recommended Workflow**:
```yaml
# Phase 1: Discovery (Type 1)
IMP-5-0-0-09:
  requirements:
    value: N/A
  waivers:
    value: N/A
  # → Run checker, see what latches are inferred
```

Review Type 1 output to understand which latches exist, then:
- Document intentional latches → Move to Type 2
- Add waivers for exceptions → Move to Type 3/4

### 2. Document All Intentional Latches

**Good Practice**:
```yaml
requirements:
  value: 0
  pattern_items:
    - CKLNQD1BWP143M286H3P48CPDLVT  # Clock gating latch - approved by arch team
    - CDC_LATCH_XYZ                 # CDC synchronizer - per spec Section 4.2
```

**Why**:
- Clear intent in configuration
- Easier design reviews
- Prevents accidental removal
- Self-documenting design decisions

### 3. Use Descriptive Waiver Reasons

**Bad**:
```yaml
waivers:
  pattern_items:
    - TEMP_LATCH_*
  reasons:
    - "TEMP_LATCH_*: Waived"  # Not helpful
```

**Good**:
```yaml
waivers:
  pattern_items:
    - TEMP_LATCH_*
  reasons:
    - "TEMP_LATCH_*: Clock gating workaround for timing closure, planned fix in V2.1 (JIRA-1234)"
```

**Why**: Future maintainers understand context and can prioritize fixes.

### 4. Minimize Waiver Scope

**Avoid**:
```yaml
waivers:
  pattern_items:
    - "*"  # Too broad - waives everything!
```

**Prefer**:
```yaml
waivers:
  pattern_items:
    - SPECIFIC_LATCH_NAME
    - MODULE_XYZ_LATCH_*  # Narrow wildcard
```

**Why**: Broad wildcards can hide new unintended latches.

### 5. Review Unused Waivers Regularly

When you see:
```
WARN01: Unused waiver patterns:
  - OLD_LATCH_PATTERN
```

**Action**: Remove obsolete waivers from configuration.

**Why**: Keeps configuration clean and prevents confusion.

### 6. Track Latch Counts Over Time

**Monitoring**:
```bash
# Extract latch count from reports
grep "Latch cell inferred (count:" reports/IMP-5-0-0-09.rpt

# Trend analysis
V1.0: 0 latches  ← Ideal
V1.1: 2 latches  ← Investigate cause
V1.2: 8 latches  ← Red flag - review design
```

**Why**: Increasing latch counts may indicate:
- Coding errors (incomplete case statements)
- Unintended behavior changes
- Need for design review

### 7. Coordinate with Synthesis Team

**Communication Points**:
1. **Before synthesis**: Which latches are intentional?
2. **After synthesis**: Review latch.rpt together
3. **During debug**: Why was this latch inferred?

**Example Email**:
```
Synthesis team,

IMP-5-0-0-09 reports 3 new latches in build V2.1:
- LATCH_CELL_XYZ (count: 12)

Please confirm:
1. Is this intentional? (RTL change or synthesis optimization)
2. Should we document or waive these?
3. Any timing/DFT impact?

Thanks,
PD Team
```

### 8. Integrate into CI/CD Pipeline

**Example Pipeline Step**:
```yaml
# .gitlab-ci.yml
synthesis_check:
  script:
    - python IMP-5-0-0-09.py
    - if grep "^FAIL" reports/IMP-5-0-0-09.rpt; then
        exit 1
      fi
  artifacts:
    paths:
      - reports/IMP-5-0-0-09.rpt
```

**Why**: Catch undocumented latches early, before tape-out.

### 9. Type Selection Guide

| Scenario | Recommended Type | Reason |
|----------|------------------|--------|
| Design exploration, early dev | **Type 1** | No enforcement, just visibility |
| Production design with known latches | **Type 2** | Enforce documentation |
| Legacy design with exceptions | **Type 3** | Documentation + waivers |
| Zero-latch policy with rare exceptions | **Type 4** | Strict enforcement, waiver-only |

### 10. Validate Latch Reports Manually

**Periodic Audit**:
1. Open latch.rpt in text editor
2. Spot-check instance paths match expectations
3. Verify cell names are from correct library
4. Cross-reference with RTL intent

**Example Check**:
```bash
# Count latch instances in report
grep "^inst:" latch.rpt | wc -l

# Count unique latch cells
grep "^inst:" latch.rpt | awk '{print $NF}' | sort -u | wc -l

# Compare with checker output
grep "count:" reports/IMP-5-0-0-09.rpt
```

---

## Summary

**IMP-5-0-0-09** provides comprehensive latch validation with:

✅ **Flexible checking**: 4 types from informational to strict enforcement  
✅ **Documentation tracking**: Validate against approved latch list  
✅ **Waiver support**: Handle exceptions with traceability  
✅ **Detailed reporting**: Cell names, counts, line numbers  
✅ **Wildcard matching**: Efficient pattern-based validation  

**Key Benefits**:
- Prevents undocumented latches from entering production
- Supports both strict (zero-latch) and permissive policies
- Integrates with existing synthesis flows
- Provides clear audit trail for design reviews

**Next Steps**:
1. Run Type 1 to discover existing latches
2. Document intentional latches in pattern_items
3. Add waivers for temporary exceptions
4. Enable in CI/CD pipeline for continuous validation
